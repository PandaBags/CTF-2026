#!/usr/bin/env python3
from Crypto.Util.number import *
import hashlib

def enhanced_security_layer(data):
    return hashlib.sha256(str(data).encode()).hexdigest()

flag = open("flag.txt","rb").read().strip()

entropy_pool = getPrime(2048)
security_factor = getPrime(2048) 
modulus_base = entropy_pool * security_factor

key_strength = 65537
temporal_seed = getRandomNBitInteger(128)

phi = (entropy_pool-1)*(security_factor-1)
while True:
    quantum_state = getRandomNBitInteger(512)
    if GCD(quantum_state, phi) == 1:
        private_vector = quantum_state
        break

public_vector = inverse(private_vector, (entropy_pool-1)*(security_factor-1))

message_vector = bytes_to_long(flag)
encrypted_payload = pow(message_vector, public_vector, modulus_base)

print(f"n = {modulus_base}")
print(f"e = {public_vector}")
print(f"c = {encrypted_payload}")

# Output
# n = 302173962901875380378939526920938450604332296253825993934347122583753790451475439739178688902098492185682372912381257049042574314600965330630564127025687989227515845093954019085547526705546930494550860722831453519762388666916588103837730127654146119158593492602181254238424891886592834707046614924832202444165108194826366764063772734791450299715166604271585183387403565818542289790816789542545484758401217617493379753058892844549560541585622073375325911967211093438250972097948716589634511188694425258183162207544950911798571884628033055671306174520574709234199865751899210253272199952282036193312117952981790012509264354085188816230909797118363573266645554045158142894949116972865068938646298269414749019635751084484886889238339426242002920196574927143639170101322728135782853650051738045124437236439797617246517947302908580230242518523672889913256888044999386234751391361265679448799888513353199155478467205510930109745900893176636169833680010496080332463726150386132162467840450590379843056174690895028626655956685171348062542942242480146757258675209519975229011499013768179187509859523453959345688690747124743240229979185880439695619727465777638756983710294228544769848072204204056050914734678810400474368509299266913149541900407
# e = 2706369223984409165147793548594831090619258344911485654126938691749725544042416715453022094643520430580648005954728994892210062113455447470541007446013857845775227597161687282846478313033102610839860351901100599451455817290046097310431722881808318196328751838048270252751526609290406609889045253050335353674570472183791942846107970425081973389134987014546982101100848587751333825689878519693072045370791243163479479996305160291647015535567797390954463471840505568207549706273507197141801031439233758622333344601235468820535512781523249617322820596981888633967992757700787587964902550033952235554826323046733374316358605539284050719549555891654046409775384508458266673262524579588692197724792723147770758491528764376445158262776312996697206262805494314416923976148457945540336163690320155970281387196495448887889974958206422974059049254418716474628697048605704676240618149165051924889144266858394139886171865881872443243872197608206436383941674152660923218981834026256868375347620050382075072938969472152627285742873039338034363872464654473300221155551254161882962921373504722567372194109099755690210574263258333470065026342909985202032141515285636461252376728345063457709858813766630090787588829879275381909492303631662782296455563
# c = 189533280121198235222251042359294223882527125354984525668745364132611323827169154189303381252117493157117400892387921703547416639342653168430969080076335649422175461153639786882669244279671957519769182761539392708352844623963649996319912193500883511557220951341139746585281868753313566527491589717430818203627861190646189769938771219151800190973480152138877059758014298697701311862667360940316767551792367106828246559228060830922105712984900761952122933174952088460996551759396226765631268736258142577828030255298028686183620825611015645469711369553408234518541940879341916433783525644069849123523437109647585568217037398594936815021038917473540929986776820288819459715110044390840269047538208704069641378756829444545533567625877068487794581306267872624090777753864504346480417274340992806415321884905458711380625652906344147551381846624154924321307949166913747438268248337273195139923650284347885064853783013182140460781410153719663061191524379449044075289437475963880933759238553120380351225602965361526243281634944000215187463759985579880382610889603429371465819151874712431983523074653939098483009195827496961087940185186252008785109977100071743750864450320752086376921765894246961367093812513243067372789841229448370266464209215

